CREATE DATABASE StudentDB;
GO

USE StudentDB;
GO

-- Bảng Người Dùng (cho đăng nhập)
CREATE TABLE Users (
    UserID INT PRIMARY KEY IDENTITY(1,1),
    Username NVARCHAR(50) NOT NULL,
    Password NVARCHAR(50) NOT NULL  -- Nên hash trong thực tế
);

-- Bảng Lớp Học
CREATE TABLE Classes (
    ClassID INT PRIMARY KEY IDENTITY(1,1),
    ClassName NVARCHAR(50) NOT NULL
);

-- Bảng Môn Học
CREATE TABLE Subjects (
    SubjectID INT PRIMARY KEY IDENTITY(1,1),
    SubjectName NVARCHAR(100) NOT NULL
);

-- Bảng Sinh Viên
CREATE TABLE Students (
    StudentID INT PRIMARY KEY IDENTITY(1,1),
    Name NVARCHAR(100) NOT NULL,
    DOB DATE NOT NULL,
    Gender NVARCHAR(10) NOT NULL,
    ClassID INT FOREIGN KEY REFERENCES Classes(ClassID)
);

-- Bảng Điểm
CREATE TABLE Grades (
    GradeID INT PRIMARY KEY IDENTITY(1,1),
    StudentID INT FOREIGN KEY REFERENCES Students(StudentID),
    SubjectID INT FOREIGN KEY REFERENCES Subjects(SubjectID),
    Grade DECIMAL(5,2) NOT NULL
);

-- Insert dữ liệu mẫu
INSERT INTO Users (Username, Password) VALUES ('admin', 'admin123');
INSERT INTO Classes (ClassName) VALUES ('Lớp 10A'), ('Lớp 11B');
INSERT INTO Subjects (SubjectName) VALUES ('Toán'), ('Văn');
INSERT INTO Students (Name, DOB, Gender, ClassID) VALUES ('Nguyễn Văn A', '2000-01-01', 'Nam', 1);
INSERT INTO Grades (StudentID, SubjectID, Grade) VALUES (1, 1, 8.5);



USE StudentDB;
GO

/* ===== Users (them tai khoan mau) ===== */
INSERT INTO Users (Username, Password) VALUES
('user01','123456'),
('user02','123456'),
('teacher_toan','toan@123'),
('teacher_van','van@123');
GO

/* ===== Classes (bo sung nhieu lop) ===== */
INSERT INTO Classes (ClassName) VALUES
('Lop 10B'),
('Lop 10C'),
('Lop 11A'),
('Lop 11C'),
('Lop 12A'),
('Lop 12B'),
('Lop 12C');
GO
-- (Da co Lop 10A, Lop 11B o script ban dau)

/* ===== Subjects (bo sung nhieu mon) ===== */
INSERT INTO Subjects (SubjectName) VALUES
('Ly'),
('Hoa'),
('Sinh'),
('Su'),
('Dia'),
('Tieng Anh'),
('Tin hoc'),
('The duc');
GO
-- (Da co Toan, Van o script ban dau)

/* ===== Students (them nhieu sinh vien) ===== */
/* Dung SELECT de lay ClassID theo ten lop -> tranh phu thuoc ID cu the */
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Bui Thi A','2007-02-14','Nu', ClassID FROM Classes WHERE ClassName='Lop 10A';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Le Van B','2007-05-20','Nam', ClassID FROM Classes WHERE ClassName='Lop 10B';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Pham Quang C','2007-09-03','Nam', ClassID FROM Classes WHERE ClassName='Lop 10C';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Nguyen Thi E','2006-11-11','Nu', ClassID FROM Classes WHERE ClassName='Lop 11A';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Do Minh F','2006-07-01','Nam', ClassID FROM Classes WHERE ClassName='Lop 11B';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Bui Lan G','2006-12-22','Nu', ClassID FROM Classes WHERE ClassName='Lop 11C';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Hoang Gia H','2005-04-18','Nam', ClassID FROM Classes WHERE ClassName='Lop 12A';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Phan Bao I','2005-08-27','Nam', ClassID FROM Classes WHERE ClassName='Lop 12B';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Dang Khoa K','2005-10-05','Nam', ClassID FROM Classes WHERE ClassName='Lop 12C';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Vo Nhat L','2007-03-09','Nu', ClassID FROM Classes WHERE ClassName='Lop 10A';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Ngo Tuan M','2006-01-30','Nam', ClassID FROM Classes WHERE ClassName='Lop 11B';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Phan Kim N','2005-06-06','Nu', ClassID FROM Classes WHERE ClassName='Lop 12A';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Nguyen Duc O','2007-12-12','Nam', ClassID FROM Classes WHERE ClassName='Lop 10B';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Le My P','2006-02-02','Nu', ClassID FROM Classes WHERE ClassName='Lop 11C';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Le Hoang Q','2005-05-15','Nam', ClassID FROM Classes WHERE ClassName='Lop 12B';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Vu Anh R','2006-09-21','Nam', ClassID FROM Classes WHERE ClassName='Lop 11A';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Ngo Bao S','2007-07-07','Nam', ClassID FROM Classes WHERE ClassName='Lop 10C';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Luong Hai T','2005-01-17','Nu', ClassID FROM Classes WHERE ClassName='Lop 12C';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Mai Quynh U','2006-03-28','Nu', ClassID FROM Classes WHERE ClassName='Lop 11A';
INSERT INTO Students (Name, DOB, Gender, ClassID)
SELECT 'Pham Thanh Z','2007-11-08','Nam', ClassID FROM Classes WHERE ClassName='Lop 10B';
GO
-- (Da co Nguyen Van A trong script ban dau)

/* ===== Grades (them diem cho nhieu SV/mon) ===== */
/* Dung join theo ten SV va ten mon. Neu ten trung nhau thi hay doi ten cho duy nhat. */

-- Nguyen Van A
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.50 FROM Students s JOIN Subjects sub ON sub.SubjectName='Toan' WHERE s.Name='Nguyen Van A';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.80 FROM Students s JOIN Subjects sub ON sub.SubjectName='Van'  WHERE s.Name='Nguyen Van A';

-- Tran Thi B
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.20 FROM Students s JOIN Subjects sub ON sub.SubjectName='Toan' WHERE s.Name='Tran Thi B';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.90 FROM Students s JOIN Subjects sub ON sub.SubjectName='Van'  WHERE s.Name='Tran Thi B';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.60 FROM Students s JOIN Subjects sub ON sub.SubjectName='Ly'   WHERE s.Name='Tran Thi B';

-- Le Van C
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.50 FROM Students s JOIN Subjects sub ON sub.SubjectName='Toan' WHERE s.Name='Le Van C';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 6.90 FROM Students s JOIN Subjects sub ON sub.SubjectName='Van'  WHERE s.Name='Le Van C';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.20 FROM Students s JOIN Subjects sub ON sub.SubjectName='Hoa'  WHERE s.Name='Le Van C';

-- Pham Quang D
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 9.00 FROM Students s JOIN Subjects sub ON sub.SubjectName='Toan' WHERE s.Name='Pham Quang D';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.30 FROM Students s JOIN Subjects sub ON sub.SubjectName='Ly'   WHERE s.Name='Pham Quang D';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.10 FROM Students s JOIN Subjects sub ON sub.SubjectName='Tin hoc' WHERE s.Name='Pham Quang D';

-- Nguyen Thi E
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.80 FROM Students s JOIN Subjects sub ON sub.SubjectName='Toan' WHERE s.Name='Nguyen Thi E';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 9.10 FROM Students s JOIN Subjects sub ON sub.SubjectName='Van'  WHERE s.Name='Nguyen Thi E';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.20 FROM Students s JOIN Subjects sub ON sub.SubjectName='Tieng Anh' WHERE s.Name='Nguyen Thi E';

-- Do Minh F
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 6.80 FROM Students s JOIN Subjects sub ON sub.SubjectName='Toan' WHERE s.Name='Do Minh F';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.40 FROM Students s JOIN Subjects sub ON sub.SubjectName='Ly'   WHERE s.Name='Do Minh F';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.90 FROM Students s JOIN Subjects sub ON sub.SubjectName='Hoa'  WHERE s.Name='Do Minh F';

-- Bui Lan G
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.70 FROM Students s JOIN Subjects sub ON sub.SubjectName='Van'  WHERE s.Name='Bui Lan G';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.30 FROM Students s JOIN Subjects sub ON sub.SubjectName='Su'   WHERE s.Name='Bui Lan G';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.50 FROM Students s JOIN Subjects sub ON sub.SubjectName='Dia'  WHERE s.Name='Bui Lan G';

-- Hoang Gia H
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 9.20 FROM Students s JOIN Subjects sub ON sub.SubjectName='Toan' WHERE s.Name='Hoang Gia H';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.60 FROM Students s JOIN Subjects sub ON sub.SubjectName='Ly'   WHERE s.Name='Hoang Gia H';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.40 FROM Students s JOIN Subjects sub ON sub.SubjectName='Tin hoc' WHERE s.Name='Hoang Gia H';

-- Phan Bao I
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.30 FROM Students s JOIN Subjects sub ON sub.SubjectName='Toan' WHERE s.Name='Phan Bao I';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.00 FROM Students s JOIN Subjects sub ON sub.SubjectName='Sinh' WHERE s.Name='Phan Bao I';

-- Dang Khoa K
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.10 FROM Students s JOIN Subjects sub ON sub.SubjectName='Toan' WHERE s.Name='Dang Khoa K';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.80 FROM Students s JOIN Subjects sub ON sub.SubjectName='Ly'   WHERE s.Name='Dang Khoa K';

-- Vo Nhat L
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.60 FROM Students s JOIN Subjects sub ON sub.SubjectName='Van' WHERE s.Name='Vo Nhat L';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.10 FROM Students s JOIN Subjects sub ON sub.SubjectName='Tieng Anh' WHERE s.Name='Vo Nhat L';

-- Ngo Tuan M
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.90 FROM Students s JOIN Subjects sub ON sub.SubjectName='Toan' WHERE s.Name='Ngo Tuan M';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.40 FROM Students s JOIN Subjects sub ON sub.SubjectName='Hoa'  WHERE s.Name='Ngo Tuan M';

-- Phan Kim N
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 9.10 FROM Students s JOIN Subjects sub ON sub.SubjectName='Tin hoc' WHERE s.Name='Phan Kim N';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.00 FROM Students s JOIN Subjects sub ON sub.SubjectName='Toan'    WHERE s.Name='Phan Kim N';

-- Nguyen Duc O
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 6.90 FROM Students s JOIN Subjects sub ON sub.SubjectName='Dia' WHERE s.Name='Nguyen Duc O';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.20 FROM Students s JOIN Subjects sub ON sub.SubjectName='Su'  WHERE s.Name='Nguyen Duc O';

-- Le My P
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.00 FROM Students s JOIN Subjects sub ON sub.SubjectName='Van' WHERE s.Name='Le My P';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.70 FROM Students s JOIN Subjects sub ON sub.SubjectName='Sinh' WHERE s.Name='Le My P';

-- Tran Hoang Q
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.30 FROM Students s JOIN Subjects sub ON sub.SubjectName='Toan' WHERE s.Name='Tran Hoang Q';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.50 FROM Students s JOIN Subjects sub ON sub.SubjectName='Ly'   WHERE s.Name='Tran Hoang Q';

-- Vu Anh R
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.60 FROM Students s JOIN Subjects sub ON sub.SubjectName='Toan' WHERE s.Name='Vu Anh R';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.20 FROM Students s JOIN Subjects sub ON sub.SubjectName='Tieng Anh' WHERE s.Name='Vu Anh R';

-- Ngo Bao S
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.40 FROM Students s JOIN Subjects sub ON sub.SubjectName='Hoa' WHERE s.Name='Ngo Bao S';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.90 FROM Students s JOIN Subjects sub ON sub.SubjectName='Ly'  WHERE s.Name='Ngo Bao S';

-- Luong Hai T
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.80 FROM Students s JOIN Subjects sub ON sub.SubjectName='Van' WHERE s.Name='Luong Hai T';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.10 FROM Students s JOIN Subjects sub ON sub.SubjectName='Su'  WHERE s.Name='Luong Hai T';

-- Mai Quynh U
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.40 FROM Students s JOIN Subjects sub ON sub.SubjectName='Toan' WHERE s.Name='Mai Quynh U';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 8.90 FROM Students s JOIN Subjects sub ON sub.SubjectName='Van'  WHERE s.Name='Mai Quynh U';

-- Pham Thanh V
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.50 FROM Students s JOIN Subjects sub ON sub.SubjectName='Toan' WHERE s.Name='Pham Thanh V';
INSERT INTO Grades (StudentID, SubjectID, Grade)
SELECT s.StudentID, sub.SubjectID, 7.60 FROM Students s JOIN Subjects sub ON sub.SubjectName='Ly'   WHERE s.Name='Pham Thanh V';
GO
